<!DOCTYPE html>
<html>
<head>

<style>
	td{text-align:center;}
	th{text-align:right;}
</style>
<meta charset="ISO-8859-1">
<title>Insert title here</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</head>
	<body>
	

<!-- Modal -->
<div class="modal fade" id="add" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">REGISTER MODEL</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        
        <form>
			  <div class="mb-3">
			    <label for="exampleInputEmail1" class="form-label">Name</label>
			    <input type="text" class="form-control" id="name" name="name" aria-describedby="emailHelp">
			  </div>
			  
			  <div class="mb-3">
			    <label for="exampleInputEmail1" class="form-label">Number of books</label>
			    <input type="text" class="form-control" id="books" name="books" aria-describedby="emailHelp">
			  </div>
	</form>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button id="btn" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
      </div>
    </div>
  </div>
</div>




<!-- Modal -->
<div class="modal fade" id="edit" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">UPDATE MODEL</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        
        <form>
			  <div class="mb-3">
			    <label for="exampleInputEmail1" class="form-label">Name</label>
			    <input type="text" class="form-control" id="namefield" name="name" aria-describedby="emailHelp">
			  </div>
			  
			  <div class="mb-3">
			    <label for="exampleInputEmail1" class="form-label">Number of books</label>
			    <input type="text" class="form-control" id="numofbooks" name="books" aria-describedby="emailHelp">
			  </div>
	</form>
        
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button id="edit-btn" type="button" class="btn btn-primary" data-bs-dismiss="modal">Save changes</button>
      </div>
    </div>
  </div>
</div>
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="container">
	
		<div class="jumbotron">
		
			<div class="card">
			  <div class="card-header">
			
			  </div>
			  <div class="card-body">
			    <center><h5 class="card-title">AUTHOR CRUD</h></center>
			    
			    <div class="row">
			    
			    	<div class="col-md-12">
			    	
			    			<button data-bs-toggle="modal" data-bs-target="#add" style="float:right; width:90px; height:40px; border-radius: 40%;" class="btn btn-success">ADD</button>
			    			
			   				<button style="float:left; width:90px; height:40px; border-radius: 40%;" class="btn btn-success"><a href="Home.html" style="color:white; text-decoration: none;">HOME</a></button>
			    	</div>
			    	
			    	
			    	
			    	
			    			
			    	
			    
			    </div>
			    <br>
					<table class="table table-dark table-hover" id="mytable">
					  <thead>
					  
					   	<tr>
					   		<th style="text-align: center;" scope="col">NAME</th>
					   		<th style="text-align: center;" scope="col">NO:COPIES</th>
					   		<th style="text-align: center;" scope="col" colspan="2">ACTIONS</th>
					   	</tr>
					   	
		 </thead>
	<tbody>
					    
		<script>
			$(document).ready(function(){
			
			$.get('./AuthorServlet?action=getAll', function(data){
				
				for(var i=0; i<data.length; i++){
					$('#mytable').append('<tr><td data-target=name>'+data[i].authorName+'</td><td data-target=rollno>'+data[i].numOfBooks+'</td><td><button class="btn btn-danger" style="width:90px; height:40px; border-radius: 40%;" id="deletebtn" data-id='+data[i].authorId+'>Delete</button></td><td><button  class="btn btn-success" style="width:90px; height:40px; border-radius: 40%"; data-bs-toggle="modal" data-bs-target="#edit" id="updatebtn" data-id='+data[i].authorId+'>Edit</button></td></tr>');
					}
				});
			});
			
			
			
			
			
			
			
			$('#mytable').on('click', '#deletebtn', function(){
			 	 $(this).closest('tr').remove();
			 });
			 
	
			 $('#mytable').on('click', '#deletebtn', function(){
				 
				 var sid = $(this).data('id');
				 
				 
				 $.post('./AuthorServlet?action=delete',{
						
						"id":sid
						
					});
			 });
			 
	
			 
			 
			 
			 
			 
			 
			 
			 
			 $("#btn").click(function(){
					var name =$("#name").val();
					
					var books =$("#books").val();
					
					$.post('./AuthorServlet?action=create',{
						
						"name":$("#name").val(),
						"books":$("#books").val()
					
					},function(success,status)
					{
						console.log(success.getAuthorName);
						$('#mytable tbody').append('<tr><td data-target=authorName>'+name+'</td><td data-target=numOfBooks>'+books+'</td><td><button class="btn btn-danger" style="width:90px; height:40px; border-radius: 40%;" id="deletebtn" data-id='+success.authorId+'>Delete</button></td><td><button  class="btn btn-success" style="width:90px; height:40px; border-radius: 40%"; data-bs-toggle="modal" data-bs-target="#edit" id="updatebtn" data-id='+success.authorId+'>Edit</button></td></tr>');
					
					});
				});
			  
			 
			 var id;
			 
			 $('#mytable').on('click', '#updatebtn', function(){
					
					
				 
				 var row = $(this).closest('tr');
				 
				 id = $(this).data('id');
		
				 
				  name = row.find('td:eq(0)').text();
				  
				 $('#namefield').val(name);
				 
				 
				  books = row.find('td:eq(1)').text();
				 $('#numofbooks').val(books);
				 
				 
				 
			 });
			 
			 
			 
			 
			 

				$("#edit-btn").click(function(){
				
					
					var name=$("#namefield").val();
					
					var books=$("#numofbooks").val();
					
					$.post('./AuthorServlet?action=update',{
						
						"id":id,		
						
						"name":$("#namefield").val(),
						
						"books":$("#numofbooks").val()
					},function(data,status){
						
						$('#'+id).children('td[data-target=author_name]').text(name);
						$('#'+id).children('td[data-target=num_of_books]').text(books);
									
						//$('#mytable').append('<tr><td>'+success.name+'</td><td>'+success.rollno+'</td><td>'+success.age+'</td><td>'+success.email+'</td></tr>');
						
					});
					
				});
		</script>
					 
	 </tbody>
</table>
		
	
	
	</div>
	
</body>
</html>